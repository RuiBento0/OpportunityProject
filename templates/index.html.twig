{% extends 'base.html.twig' %} 


{% block body %}

    <div class="page-wrapper">

            <!-- Page Content-->
  

                <div class="container-fluid">
                    <!-- Page-Title -->
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="page-title-box">
                                <div class="float-end">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="/index">Business</a>
                                        </li><!--end nav-item-->
                                        <li class="breadcrumb-item active">Business</li>
                                    </ol>
                                </div>
                                <h4 class="page-title">Business</h4>
                            </div><!--end page-title-box-->
                        </div><!--end col-->
                    </div>
                    <!-- end page title end breadcrumb -->
                    <div class="row justify-content-center">
                        <div class="col-md-6 col-lg-3">
                            <div class="card report-card">
                                <div class="card-body">
                                    <div class="row d-flex justify-content-center">
                                        <div class="col">
                                            <p class="text-dark mb-1 fw-semibold">{% trans %}Accounts{% endtrans %}</p>
                                            <h4 class="my-1">
                                            {% for accountscount in accountscount %}
                                            {{ accountscount.counter }}
                                            {% endfor %}
                                            </h4>
                                        </div>
                                        <div class="col-auto align-self-center">
                                            <div class="bg-light-alt d-flex justify-content-center align-items-center thumb-md  rounded-circle">
                                                <i data-feather="layers" class="align-self-center text-muted icon-sm"></i>  
                                            </div>
                                        </div>
                                    </div>
                                </div><!--end card-body--> 
                            </div><!--end card--> 
                        </div> <!--end col--> 
                        <div class="col-md-6 col-lg-3">
                            <div class="card report-card">
                                <div class="card-body">
                                    <div class="row d-flex justify-content-center">                                                
                                        <div class="col">
                                            <p class="text-dark mb-1 fw-semibold">{% trans %}New Accounts{% endtrans %}</p>
                                            <h4 class="my-1">
                                            {% for newcountaccounts in newcountaccounts %}
                                            {{ newcountaccounts.counter }}
                                            {% endfor %}
                                            </h4>     
                                        </div>
                                        <div class="col-auto align-self-center">
                                            <div class="bg-light-alt d-flex justify-content-center align-items-center thumb-md  rounded-circle">
                                                <i data-feather="check-square" class="align-self-center text-muted icon-sm"></i>  
                                            </div>
                                        </div> 
                                    </div>
                                </div><!--end card-body--> 
                            </div><!--end card--> 
                        </div> <!--end col-->                         
                        <div class="col-md-6 col-lg-3">
                            <div class="card report-card">
                                <div class="card-body">
                                    <div class="row d-flex justify-content-center">
                                        <div class="col">  
                                            <p class="text-dark mb-1 fw-semibold">{% trans %}New Opportunities{% endtrans %}</p>  
                                            <h4 class="my-1">
                                            {% for newcountopportunities in newcountopportunities %}
                                            {{ newcountopportunities.counter }}
                                            {% endfor %}
                                            </h4>   
                                        </div>
                                        <div class="col-auto align-self-center">
                                            <div class="bg-light-alt d-flex justify-content-center align-items-center thumb-md  rounded-circle">
                                                <i data-feather="dollar-sign" class="align-self-center text-muted icon-sm"></i>  
                                            </div>
                                        </div> 
                                    </div>
                                </div><!--end card-body--> 
                            </div><!--end card--> 
                        </div> <!--end col--> 
                        <div class="col-md-6 col-lg-3">
                            <div class="card report-card">
                                <div class="card-body">
                                    <div class="row d-flex justify-content-center">                                                
                                        <div class="col">
                                            <p class="text-dark mb-1 fw-semibold">{% trans %}New Leads{% endtrans %}</p>
                                            <h4 class="my-1">
                                            {% for newcountleads in newcountleads %}
                                            {{ newcountleads.counter }}
                                            {% endfor %}
                                            </h4>   
                                        </div>
                                        <div class="col-auto align-self-center">
                                            <div class="bg-light-alt d-flex justify-content-center align-items-center thumb-md  rounded-circle">
                                                <i data-feather="dollar-sign" class="align-self-center text-muted icon-sm"></i>  
                                            </div>
                                        </div> 
                                    </div>
                                </div><!--end card-body--> 
                            </div><!--end card--> 
                        </div> <!--end col-->                               
                    </div><!--end row-->

                    <div class="row">
                        
                    
                    <div class="col-md-12 col-lg-8">
                            <div class="card">
                                <div class="card-header">
                                    <div class="row align-items-center">
                                        <div class="col">                      
                                            <h4 class="card-title">{% trans %}Monthly Trends{% endtrans %}</h4>                   
                                        </div><!--end col-->                                      
                                    </div>  <!--end row-->                                  
                                </div><!--end card-header-->
                                <div class="card-body">
                                    <div class="row">
                                         <div class="row py-2">
                                            
                                                
                                                    <div class="card-body">
                                                        <canvas id="chDonut3"></canvas>
                                                    </div>
                                                
                                            
                                        </div>
                                    </div> <!--end row--> 
                                </div><!--end card-body-->
                            </div><!--end  card-->                                                                                                          
                        </div><!--end col-->
                    </div>  <!--end row--> 

                 
                           
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-header">
                                    <div class="row align-items-center">
                                        <div class="col">                      
                                            <h4 class="card-title">{% trans %}Users{% endtrans %}</h4>                      
                                        </div><!--end col-->
                                    </div>  <!--end row-->                                  
                                </div><!--end card-header-->
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table mb-0" >
                                            <thead class="thead-light">
                                                <tr>
                                                    <th onclick="sortTable(0)" style="cursor: pointer">{% trans %}Users{% endtrans %}</th>
                                                    <th onclick="sortTable(1)" style="cursor: pointer">{% trans %}Email{% endtrans %}</th>
                                                    <th onclick="sortTable(3)" style="cursor: pointer">{% trans %}Role{% endtrans %}</th>
                                                    <th onclick="sortTable(4)" style="cursor: pointer">{% trans %}Status{% endtrans %}</th>
                                                    <th>{% trans %}Actions{% endtrans %}</th>
                                                </tr><!--end tr-->
                                            </thead>
        
                                            <tbody>
                                                <tr>
                                                    {% for user in users %}
                                                        <td><img src="{{ asset('uploads/userimg/' ~ user.photo ~ '') }}" alt="profile-user" class="rounded-circle me-2 thumb-sm" />{{ user.name }}</td>
                                                        <td>{{ user.email }}</td>
                                                        <td>{{ user.userRole.role }}</td>
                                                        <td>{% if user.active == 1 %}{% trans %}Active{% endtrans %}{% endif %}{% if user.active == 0 %}{% trans %}Disable{% endtrans %}{% endif %}</td>

                                                        <td style="-webkit-user-select: none; vertical-align: middle">

                                                    {% if app.user.id is defined%}
                                                        <a href="/authentication/users/edit/{{ user.id }}"><i class="las la-pen text-secondary font-16"></i></a>
                                                        <a href="/authentication/users/delete/{{ user.id }}"><i class="las la-trash-alt text-secondary font-16"></i></a>
                                                    {% endif %} 
                                                        </td>
                                                    </tr>
                                                {% endfor %}                                    
                                            </tbody>
                                        </table> 
                                    </div>  
                                </div><!--end card-body-->
                            </div><!--end card-->
                        </div><!--end col-->

                </div><!-- container -->

               
            </div>
            <!-- end page content -->
        </div>
        <!-- end page-wrapper -->
        
    <script src="{{ asset('js/chart.js') }}"></script>

    

    <script type="text/javascript">
            
            var colors = ['#007bff','#fd3c97','#00FF00','#c3e6cb','#dc3545','#6c757d'];
            var donutOptions = {
            cutoutPercentage: 85, 
            legend: {position:'bottom', padding:5, labels: {pointStyle:'circle', usePointStyle:true}}
            };
            var chDonutData3 = {
                labels: ['{% trans %} Leads {% endtrans %}', '{% trans %} Opportunities {% endtrans %}', '{% trans %} Wins(Opportunities) {% endtrans %}'],
                datasets: [
                {
                    backgroundColor: colors.slice(0,2),
                    borderWidth: 0,
                    data: [{{ countleads }}, {{ countopportunities }}, {{ countopportunitieswon }}]
                }
                ]
            };

            var chDonut3 = document.getElementById("chDonut3");
                if (chDonut3) {
                    new Chart(chDonut3, {
                        type: 'pie',
                        data: chDonutData3,
                        options: donutOptions
                    });
                }


           
    </script>

{% endblock %}